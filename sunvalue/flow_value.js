console.log(
  "%c EXP: Introduce value proposition and increase engagement during the flow (DEV: Olha)",
  "background: #3498eb; color: #fccf3a; font-size: 20px; font-weight: bold;"
);

const dir = "https://conversionratestore.github.io/projects/sunvalue/img/";
const media = window.innerWidth < 769;

const dataState = new Promise((resolve, reject) => {
  fetch(
    "https://raw.githubusercontent.com/millbj92/US-Zip-Codes-JSON/master/USCities.json"
  )
    .then((data) => data.json())
    .then((data) => resolve(data));
});

const clarityInterval = setInterval(function () {
  if (typeof clarity == "function") {
    clearInterval(clarityInterval);
    clarity("set", "exp_valu_prop", "variant_1");
  }
}, 200);

const device = window.innerWidth < 769 ? "mobile" : "desktop";

const dataIcons = {
  settings: `
        <svg xmlns="http://www.w3.org/2000/svg" width="42" height="42" viewBox="0 0 42 42" fill="none">
            <mask id="mask0_552_2335" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="0" y="0" width="42" height="42">
                <path d="M0 0H42V42H0V0Z" fill="white"/>
            </mask>
            <g mask="url(#mask0_552_2335)">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M3.30702 18.6366C3.97765 18.7866 4.64243 18.3623 4.79186 17.6888C6.04943 12.0207 10.1923 7.17336 16.0887 5.31326L17.795 4.77505C18.4505 4.56829 18.815 3.86702 18.6091 3.20873C18.4032 2.55044 17.7049 2.1844 17.0494 2.39116L15.3431 2.92938L15.343 2.92939C8.56249 5.0684 3.80583 10.6436 2.3633 17.1454C2.21387 17.8189 2.63639 18.4865 3.30702 18.6366Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M14.4949 9.19233C15.1064 9.50979 15.8603 9.27282 16.1787 8.66306L18.5254 4.16884C18.8433 3.55996 18.6069 2.80938 17.9969 2.49113L13.4942 0.142033C12.8833 -0.176687 12.1289 0.0587215 11.8093 0.667832C11.4896 1.27694 11.7257 2.0291 12.3366 2.34782L15.7354 4.12101L13.964 7.51343C13.6456 8.1232 13.8833 8.87487 14.4949 9.19233Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M23.3908 38.7914C23.5967 39.4497 24.295 39.8158 24.9505 39.609L26.6569 39.0706C26.6569 39.0706 26.6569 39.0706 26.6569 39.0706C33.4369 36.9317 38.1934 31.3567 39.6365 24.855C39.786 24.1815 39.3636 23.5138 38.6929 23.3636C38.0223 23.2135 37.3574 23.6378 37.2079 24.3113C35.9499 29.9793 31.8072 34.8264 25.9112 36.6865L24.2048 37.2249C23.5493 37.4317 23.1849 38.133 23.3908 38.7914Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M30.1907 41.3321C30.5104 40.723 30.2743 39.9708 29.6634 39.6521L26.2646 37.8789L28.036 34.4865C28.3544 33.8767 28.1167 33.1251 27.5051 32.8076C26.8936 32.4901 26.1397 32.7271 25.8213 33.3369L23.4746 37.8311C23.1567 38.44 23.3931 39.1905 24.0031 39.5088L28.5058 41.8579C29.1167 42.1766 29.8711 41.9412 30.1907 41.3321Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M18.6359 38.6977C18.7873 38.029 18.364 37.3651 17.6905 37.2149C12.0305 35.952 7.18316 31.808 5.31682 25.9126C5.3168 25.9125 5.31677 25.9124 5.31675 25.9123L4.77595 24.2028C4.5691 23.549 3.86754 23.1854 3.20896 23.3908C2.55038 23.5961 2.18417 24.2926 2.39102 24.9465L2.93196 26.6564C5.07583 33.4289 10.6469 38.187 17.1424 39.6363C17.8159 39.7866 18.4845 39.3663 18.6359 38.6977Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M0.671216 30.192C1.28191 30.5102 2.03472 30.2727 2.35267 29.6615L4.11915 26.2659L7.50845 28.0408C8.11849 28.3602 8.87179 28.1243 9.191 27.5138C9.51021 26.9033 9.27445 26.1494 8.66441 25.8299L4.16825 23.4754C3.8749 23.3218 3.53255 23.2913 3.21668 23.3906C2.90082 23.4899 2.63739 23.7108 2.48451 24.0047L0.14114 28.5093C-0.176803 29.1204 0.0605198 29.8738 0.671216 30.192Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M38.7916 18.6095C39.4497 18.4046 39.8156 17.7098 39.6088 17.0575L39.0592 15.3232C39.0583 15.3205 39.0575 15.3177 39.0566 15.315C36.9151 8.55765 31.3478 3.80995 24.8564 2.36382C24.1834 2.21388 23.5152 2.63308 23.3639 3.30013C23.2127 3.96717 23.6356 4.62946 24.3086 4.77939C29.9627 6.03899 34.8051 10.171 36.6711 16.0496C36.6725 16.0541 36.6739 16.0587 36.6754 16.0633L37.2257 17.7995C37.4324 18.4517 38.1335 18.8144 38.7916 18.6095Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M38.7838 18.6103C39.094 18.5126 39.3527 18.2951 39.5028 18.0059L41.8615 13.4618C42.1737 12.8604 41.9406 12.1189 41.3409 11.8058C40.7412 11.4926 40.002 11.7264 39.6897 12.3279L37.8976 15.7805L34.4588 13.9759C33.8597 13.6615 33.12 13.8937 32.8065 14.4946C32.4931 15.0954 32.7246 15.8374 33.3237 16.1517L37.8494 18.5268C38.1375 18.678 38.4737 18.708 38.7838 18.6103Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M12.8333 21.0001C12.8333 25.5104 16.4895 29.1667 20.9999 29.1667C25.5103 29.1667 29.1666 25.5104 29.1666 21.0001C29.1666 16.4898 25.5103 12.8334 20.9999 12.8334C16.4895 12.8334 12.8333 16.4898 12.8333 21.0001ZM20.9999 26.5711C17.9231 26.5711 15.429 24.0768 15.429 21.0001C15.429 17.9233 17.9231 15.4291 20.9999 15.4291C24.0767 15.4291 26.5709 17.9233 26.5709 21.0001C26.5709 24.0768 24.0767 26.5711 20.9999 26.5711Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M17.1757 17.0948C17.608 16.5545 17.608 15.6785 17.1757 15.1382L14.7227 12.0719C14.2904 11.5316 13.5897 11.5316 13.1574 12.0719C12.7252 12.6122 12.7252 13.4881 13.1574 14.0284L15.6105 17.0948C16.0427 17.6351 16.7435 17.6351 17.1757 17.0948Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M28.8425 28.8426C29.2747 28.4103 29.2747 27.7096 28.8425 27.2773L26.3894 24.8243C25.9572 24.392 25.2564 24.392 24.8242 24.8243C24.3919 25.2565 24.3919 25.9573 24.8242 26.3895L27.2773 28.8426C27.7095 29.2748 28.4103 29.2748 28.8425 28.8426Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M13.1574 28.8426C13.5897 29.2748 14.2904 29.2748 14.7227 28.8426L17.1757 26.3895C17.608 25.9573 17.608 25.2565 17.1757 24.8243C16.7435 24.392 16.0427 24.392 15.6105 24.8243L13.1574 27.2773C12.7252 27.7096 12.7252 28.4103 13.1574 28.8426Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M24.8242 17.0948C25.2564 17.6351 25.9572 17.6351 26.3894 17.0948L28.8425 14.0284C29.2747 13.4881 29.2747 12.6122 28.8425 12.0719C28.4103 11.5316 27.7095 11.5316 27.2773 12.0719L24.8242 15.1382C24.3919 15.6785 24.3919 16.5545 24.8242 17.0948Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M9.33325 21.0001C9.33325 21.6444 9.84191 22.1667 10.4694 22.1667H14.0305C14.6579 22.1667 15.1666 21.6444 15.1666 21.0001C15.1666 20.3557 14.6579 19.8334 14.0305 19.8334H10.4694C9.84191 19.8334 9.33325 20.3557 9.33325 21.0001Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M26.8333 21.0001C26.8333 21.6444 27.3419 22.1667 27.9694 22.1667H31.5305C32.1579 22.1667 32.6666 21.6444 32.6666 21.0001C32.6666 20.3557 32.1579 19.8334 31.5305 19.8334H27.9694C27.3419 19.8334 26.8333 20.3557 26.8333 21.0001Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M20.9999 32.6667C21.6443 32.6667 22.1666 32.1581 22.1666 31.5306V27.9695C22.1666 27.3421 21.6443 26.8334 20.9999 26.8334C20.3556 26.8334 19.8333 27.3421 19.8333 27.9695V31.5306C19.8333 32.1581 20.3556 32.6667 20.9999 32.6667Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M20.9999 15.1667C21.6443 15.1667 22.1666 14.6581 22.1666 14.0306V10.4695C22.1666 9.84207 21.6443 9.33341 20.9999 9.33341C20.3556 9.33341 19.8333 9.84207 19.8333 10.4695V14.0306C19.8333 14.6581 20.3556 15.1667 20.9999 15.1667Z" fill="white"/>
            </g>
        </svg>`,
  location: `
        <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 36 36" fill="none">
            <g clip-path="url(#clip0_552_981)">
                <path d="M31.3085 22.1624H23.1745C26.4097 17.9999 28.4726 13.723 28.397 10.8706C28.397 4.33738 23.1107 0.43335 18 0.43335C12.8893 0.43335 7.60304 4.33738 7.60304 10.8706C7.52502 13.7203 9.59146 18.0028 12.8256 22.1624H4.6915L0 35.5667H36L31.3085 22.1624ZM29.8069 24.2788L31.1998 28.2585L19.6773 26.311C20.1516 25.7988 20.7756 25.1046 21.4724 24.2788H29.8069ZM9.71944 10.8707C9.71944 5.66222 13.9297 2.54988 18 2.54988C23.1832 2.54988 26.2805 6.78056 26.2805 10.8707C26.5069 14.598 21.1592 21.7674 18 25.0049C14.8364 21.7621 9.49326 14.5975 9.71944 10.8707ZM16.4763 26.4761L10.2448 28.4637L7.42957 24.2789H14.5276C15.3028 25.1975 15.9871 25.9523 16.4763 26.4761ZM5.74331 25.564L11.0486 33.4503H2.98309L5.74331 25.564ZM13.5994 33.4502L11.4753 30.2927L18.0769 28.187L31.9982 30.5399L33.0168 33.4502H13.5994Z" fill="white"/>
                <path d="M17.9999 15.2844C20.456 15.2844 22.4541 13.2863 22.4541 10.8303C22.2095 4.92128 13.7896 4.92297 13.5458 10.8303C13.5458 13.2863 15.5439 15.2844 17.9999 15.2844ZM17.9999 8.4926C19.2889 8.4926 20.3377 9.54131 20.3377 10.8303C20.2093 13.9315 15.7902 13.9306 15.6622 10.8303C15.6622 9.54124 16.7109 8.4926 17.9999 8.4926Z" fill="white"/>
            </g>
            <defs>
                <clipPath id="clip0_552_981">
                <rect width="36" height="36" fill="white"/>
                </clipPath>
            </defs>
        </svg>`,
  info: `
        <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 36 36" fill="none">
            <path d="M5.625 13.5H14.625V15.75H5.625V13.5Z" fill="white"/>
            <path d="M24.75 12.375C24.374 12.3747 23.9983 12.3973 23.625 12.4425V4.50002C23.625 3.60491 23.2694 2.74647 22.6365 2.11353C22.0036 1.4806 21.1451 1.12502 20.25 1.12502H7.875C7.72695 1.12416 7.58018 1.15254 7.44311 1.20853C7.30604 1.26451 7.18137 1.347 7.07625 1.45127L1.45125 7.07627C1.34699 7.18139 1.2645 7.30606 1.20851 7.44312C1.15253 7.58019 1.12415 7.72696 1.125 7.87502V31.5C1.125 32.3951 1.48058 33.2536 2.11352 33.8865C2.74645 34.5194 3.6049 34.875 4.5 34.875H20.25C20.9612 34.8714 21.653 34.6431 22.2268 34.2229C22.8006 33.8027 23.2269 33.2119 23.445 32.535C23.8776 32.5934 24.3135 32.6234 24.75 32.625C27.4353 32.625 30.0107 31.5583 31.9095 29.6595C33.8083 27.7607 34.875 25.1853 34.875 22.5C34.875 19.8147 33.8083 17.2394 31.9095 15.3406C30.0107 13.4418 27.4353 12.375 24.75 12.375ZM7.875 5.90627C7.93413 6.08778 7.9461 6.28135 7.90978 6.46876C7.87346 6.65616 7.79005 6.83125 7.6674 6.97753C7.54475 7.12381 7.38689 7.23648 7.20869 7.30492C7.03048 7.37336 6.83779 7.39534 6.64875 7.36877L4.635 7.07627L7.38 4.33127L7.875 5.90627ZM20.25 32.625H4.5C4.20163 32.625 3.91549 32.5065 3.70451 32.2955C3.49353 32.0845 3.375 31.7984 3.375 31.5V9.16877L6.3675 9.59627C6.52855 9.60784 6.69021 9.60784 6.85125 9.59627C7.34137 9.60257 7.82676 9.49986 8.27231 9.29557C8.71787 9.09127 9.11244 8.79051 9.4275 8.41502C9.79731 7.97421 10.0483 7.44618 10.1566 6.88107C10.2649 6.31597 10.2269 5.73256 10.0463 5.18627L9.43875 3.37502H20.25C20.5484 3.37502 20.8345 3.49355 21.0455 3.70452C21.2565 3.9155 21.375 4.20165 21.375 4.50002V12.9713C19.7677 13.5399 18.33 14.5052 17.1952 15.7776C16.0605 17.05 15.2654 18.5884 14.8838 20.25H5.625V22.5H14.625C14.6467 24.0669 15.0318 25.6073 15.75 27H5.625V29.25H17.2238C18.324 30.4752 19.7064 31.4136 21.2513 31.9838C21.1609 32.1735 21.0192 32.3341 20.8423 32.4475C20.6653 32.5608 20.4601 32.6223 20.25 32.625ZM24.75 30.375C23.1925 30.375 21.6699 29.9132 20.3749 29.0478C19.0799 28.1825 18.0705 26.9526 17.4745 25.5137C16.8784 24.0747 16.7225 22.4913 17.0263 20.9637C17.3302 19.4361 18.0802 18.0329 19.1815 16.9316C20.2829 15.8302 21.6861 15.0802 23.2137 14.7763C24.7413 14.4725 26.3247 14.6284 27.7636 15.2245C29.2026 15.8205 30.4325 16.8299 31.2978 18.1249C32.1631 19.4199 32.625 20.9425 32.625 22.5C32.625 24.5886 31.7953 26.5916 30.3185 28.0685C28.8416 29.5453 26.8386 30.375 24.75 30.375Z" fill="white"/>
            <path d="M25.875 21.9937C25.875 21.6953 25.7565 21.4091 25.5455 21.1982C25.3345 20.9872 25.0484 20.8687 24.75 20.8687H21.9375V23.1187H23.625V25.8749H21.9375V28.1249H27.5625V25.8749H25.875V21.9937Z" fill="white"/>
            <path d="M22.7812 16.875H25.0312V19.2488H22.7812V16.875Z" fill="white"/>
            <path d="M13.5 5.625H19.125V7.875H13.5V5.625Z" fill="white"/>
        </svg>`,
  loader: `
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
            <path d="M16 9C16 10.3845 15.5895 11.7378 14.8203 12.889C14.0511 14.0401 12.9579 14.9373 11.6788 15.4672C10.3997 15.997 8.99223 16.1356 7.63437 15.8655C6.2765 15.5954 5.02922 14.9287 4.05025 13.9497C3.07128 12.9708 2.4046 11.7235 2.1345 10.3656C1.86441 9.00777 2.00303 7.6003 2.53284 6.32122C3.06266 5.04213 3.95986 3.94888 5.11101 3.17971C6.26215 2.41054 7.61553 2 9 2" stroke="#F2F2F2" stroke-width="3" stroke-linecap="round"/>
            <path d="M9 2C9.91925 2 10.8295 2.18106 11.6788 2.53284C12.5281 2.88463 13.2997 3.40024 13.9497 4.05025C14.5998 4.70026 15.1154 5.47194 15.4672 6.32122C15.8189 7.17049 16 8.08075 16 9" stroke="#59B469" stroke-width="3" stroke-linecap="round"/>
        </svg>`,
  certificate: `
        <svg xmlns="http://www.w3.org/2000/svg" width="42" height="42" viewBox="0 0 42 42" fill="none">
            <g clip-path="url(#clip0_552_1246)">
                <path d="M13.1935 7.875H23.6935V9.62495H13.1935V7.875Z" fill="#83BE63"/>
                <path d="M13.1935 13.1252H18.4433V14.8752H13.1935V13.1252Z" fill="#83BE63"/>
                <path d="M13.1935 23.6248H18.4433V25.3751H13.1935V23.6248Z" fill="#83BE63"/>
                <path d="M13.1935 18.375H21.0684V20.1249H13.1935V18.375Z" fill="#83BE63"/>
                <path d="M13.1935 28.875H27.1934V30.6249H13.1935V28.875Z" fill="#83BE63"/>
                <path d="M40.55 11.992C40.3586 11.7535 40.261 11.4545 40.2767 11.1494C40.3459 9.75387 39.4169 8.47571 38.0684 8.11084C37.7739 8.03046 37.5189 7.84579 37.3525 7.58971C36.668 6.54146 35.3921 6.045 34.1932 6.31155V2.62511C34.1932 1.1776 33.016 0 31.5685 0H5.31853C2.90614 0 0.943481 1.96266 0.943481 4.37505V6.125H7.94327V37.6252C7.94327 38.8547 8.46552 40.0346 9.37545 40.8619C10.1796 41.5935 11.2334 41.9957 12.3183 41.9983V41.9998H36.8183C38.2658 41.9998 39.4434 40.8226 39.4434 39.3751V35.8748H34.1932V31.0373L35.2624 32.462C35.4306 32.6867 35.6923 32.8123 35.9622 32.8123C36.0546 32.8123 36.1477 32.7981 36.2389 32.7671C36.5963 32.6486 36.837 32.3144 36.837 31.9376V20.7403C37.0307 20.5687 37.2056 20.3728 37.3518 20.1489C37.5189 19.8924 37.7739 19.7081 38.0684 19.6277C39.4169 19.2629 40.3459 17.9843 40.2767 16.5892C40.261 16.2841 40.3586 15.985 40.5492 15.7473C41.4267 14.6587 41.4267 13.0796 40.55 11.992ZM2.69343 4.37505C2.69343 2.92754 3.87103 1.74995 5.31853 1.74995C6.76604 1.74995 7.94327 2.92754 7.94327 4.37505H2.69343ZM37.6935 37.6252V39.3751C37.6935 39.8577 37.3013 40.2499 36.8183 40.2499H15.8167C16.367 39.5187 16.6934 38.6095 16.6934 37.6252H37.6935ZM14.9434 35.8748V37.4745C14.9434 38.5392 14.361 39.4861 13.5127 39.9489C13.509 39.9508 13.5056 39.9531 13.5019 39.9549C13.3939 40.0132 13.278 40.0566 13.1621 40.0985C13.0952 40.1213 13.0282 40.1441 12.9595 40.1617C12.8821 40.1819 12.8028 40.1964 12.7228 40.2091C12.6335 40.223 12.543 40.2319 12.451 40.2364C11.7534 40.266 11.0746 40.042 10.553 39.5673C10.0069 39.0708 9.69321 38.3624 9.69321 37.6252V4.37505C9.69321 4.09692 9.66106 3.827 9.61134 3.56307C9.59564 3.48008 9.57059 3.40195 9.55041 3.32082C9.50555 3.14063 9.45321 2.96493 9.38667 2.79446C9.35302 2.70847 9.31601 2.62548 9.2775 2.54174C9.20236 2.38061 9.11787 2.22659 9.02441 2.07668C8.97881 2.00341 8.93581 1.92976 8.88609 1.85948C8.86142 1.82397 8.84273 1.78434 8.81656 1.74995H31.5685C32.0511 1.74995 32.4433 2.1421 32.4433 2.62511V6.30183C31.256 6.05584 29.9995 6.5523 29.3228 7.58971C29.1553 7.84579 28.9008 8.03046 28.6058 8.11084C27.2574 8.47571 26.3287 9.75387 26.3979 11.1494C26.4132 11.4545 26.3157 11.7535 26.1254 11.9909C25.2476 13.0796 25.2476 14.6587 26.1242 15.7465C26.3157 15.985 26.4132 16.2841 26.3979 16.5892C26.3287 17.9843 27.2574 19.2629 28.6058 19.6277C28.9008 19.7081 29.1553 19.8924 29.3221 20.1489C29.4671 20.3709 29.6454 20.5601 29.8372 20.7309V31.9376C29.8372 32.3144 30.078 32.6486 30.4354 32.7671C30.7958 32.8893 31.1864 32.7637 31.4118 32.462L32.4433 31.0874V35.8748H14.9434ZM35.0871 29.3124L34.0369 27.9128C33.8721 27.6922 33.6123 27.5625 33.3371 27.5625C33.062 27.5625 32.8022 27.6922 32.6373 27.9128L31.5872 29.3124V21.4827C32.0223 21.5197 32.4683 21.4719 32.8945 21.3093C33.1801 21.2001 33.4945 21.2001 33.7797 21.3093C34.1241 21.4401 34.4807 21.5033 34.8344 21.5025C34.92 21.5025 35.0022 21.4786 35.0871 21.4711V29.3124ZM39.1862 14.6493C38.7257 15.2228 38.4924 15.9424 38.5283 16.6763C38.5582 17.2651 38.1806 17.7847 37.6105 17.9391C36.9013 18.1316 36.2886 18.5758 35.886 19.1918C35.5689 19.6771 34.9461 19.8805 34.4037 19.6737C34.0594 19.5432 33.6986 19.4775 33.3371 19.4775C32.9756 19.4775 32.6152 19.5432 32.2709 19.6737C31.7289 19.8816 31.1053 19.6782 30.7875 19.1918C30.3857 18.5758 29.7733 18.1316 29.0638 17.9391C28.494 17.7847 28.1161 17.2651 28.146 16.6763C28.1819 15.9424 27.9486 15.2228 27.4873 14.6486C27.1172 14.1899 27.1172 13.5487 27.488 13.0893C27.9486 12.5158 28.1819 11.7962 28.146 11.0623C28.1161 10.4735 28.494 9.95387 29.0638 9.79948C29.7733 9.60695 30.3857 9.16283 30.7883 8.54674C31.1045 8.06037 31.7281 7.85551 32.2709 8.06486C32.9577 8.32617 33.7151 8.32617 34.4037 8.06486C34.948 7.857 35.5701 8.06037 35.8871 8.54674C36.2886 9.16283 36.9013 9.60695 37.6105 9.79948C38.1806 9.95387 38.5582 10.4735 38.5283 11.0623C38.4924 11.7962 38.7257 12.5158 39.187 13.09C39.5571 13.5487 39.5571 14.1899 39.1862 14.6493Z" fill="#83BE63"/>
                <path d="M33.3371 10.3691C31.4069 10.3691 29.8372 11.9389 29.8372 13.869C29.8372 15.7995 31.4069 17.3693 33.3371 17.3693C35.2676 17.3693 36.8369 15.7995 36.8369 13.869C36.8369 11.9389 35.2676 10.3691 33.3371 10.3691ZM33.3371 15.6194C32.3725 15.6194 31.5871 14.8339 31.5871 13.869C31.5871 12.9045 32.3725 12.1191 33.3371 12.1191C34.3019 12.1191 35.087 12.9045 35.087 13.869C35.087 14.8339 34.3019 15.6194 33.3371 15.6194Z" fill="#83BE63"/>
            </g>
            <defs>
                <clipPath id="clip0_552_1246">
                <rect width="42" height="42" fill="white"/>
                </clipPath>
            </defs>
        </svg>`,
  solarenergy: `
        <svg xmlns="http://www.w3.org/2000/svg" width="42" height="42" viewBox="0 0 42 42" fill="none">
            <path d="M8.76294 18.4048C8.57905 18.4046 8.39977 18.4623 8.25048 18.5697C8.10118 18.677 7.98944 18.8286 7.93107 19.003L2.67537 34.7787C2.63195 34.9102 2.62035 35.0502 2.6415 35.1871C2.66266 35.3241 2.71597 35.454 2.79706 35.5663C2.87816 35.6787 2.98472 35.7702 3.10802 35.8333C3.23132 35.8965 3.36784 35.9296 3.50638 35.9298H7.88571V38.5598C7.88572 38.6749 7.90842 38.7889 7.95252 38.8953C7.99662 39.0017 8.06125 39.0983 8.14272 39.1797C8.22419 39.2611 8.3209 39.3257 8.42732 39.3697C8.53374 39.4137 8.64778 39.4362 8.76294 39.4361H33.3007C33.5331 39.4361 33.756 39.3438 33.9203 39.1794C34.0847 39.0151 34.177 38.7922 34.177 38.5598V35.9298H38.5606C38.6992 35.9296 38.8357 35.8965 38.959 35.8333C39.0823 35.7702 39.1889 35.6787 39.27 35.5663C39.3511 35.454 39.4044 35.3241 39.4255 35.1871C39.4467 35.0502 39.4351 34.9102 39.3917 34.7787L34.1325 19.003C34.0742 18.8286 33.9624 18.677 33.8131 18.5697C33.6638 18.4623 33.4846 18.4046 33.3007 18.4048H8.76294ZM9.39369 20.1575H14.622L13.6481 23.6613H8.22633L9.39369 20.1575ZM16.4407 20.1575H20.155V23.6613H15.4667L16.4407 20.1575ZM21.9086 20.1575H25.6264L26.6003 23.6613H21.9086V20.1575ZM27.4442 20.1575H32.6699L33.8381 23.6613H28.4181L27.4442 20.1575ZM7.64265 25.4141H13.1611L12.1871 28.9205H6.47443L7.64265 25.4141ZM14.9797 25.4141H20.155V28.9205H14.0058L14.9797 25.4141ZM21.9086 25.4141H27.0873L28.0612 28.9205H21.9086V25.4141ZM28.9051 25.4141H34.4218L35.5909 28.9205H29.879L28.9051 25.4141ZM5.89075 30.6741H11.7002L10.7262 34.1804H4.72253L5.89075 30.6741ZM13.5188 30.6741H20.155V34.1804H12.5449L13.5188 30.6741ZM21.9086 30.6741H28.5482L29.5221 34.1804H21.9086V30.6741ZM30.3669 30.6741H36.1754L37.3445 34.1804H31.3408L30.3669 30.6741ZM9.63932 35.9298H32.4277V37.6834H9.63932V35.9298Z" fill="#83BE63"/>
            <path d="M21.0001 9.625C17.1788 9.62651 13.7175 11.8985 12.1894 15.3997C12.1431 15.5051 12.118 15.6186 12.1157 15.7337C12.1133 15.8488 12.1336 15.9633 12.1756 16.0705C12.2175 16.1778 12.2801 16.2757 12.3599 16.3587C12.4397 16.4417 12.5351 16.5081 12.6407 16.5542C12.7462 16.6002 12.8597 16.6251 12.9749 16.6272C13.09 16.6293 13.2044 16.6087 13.3115 16.5665C13.4187 16.5244 13.5165 16.4615 13.5993 16.3815C13.6821 16.3015 13.7483 16.206 13.7941 16.1004C15.0462 13.2315 17.8711 11.3763 21.0001 11.375C24.1312 11.3738 26.9599 13.2295 28.2128 16.1004C28.2587 16.2059 28.3249 16.3015 28.4077 16.3814C28.4906 16.4614 28.5883 16.5242 28.6955 16.5664C28.8026 16.6085 28.917 16.6291 29.0321 16.627C29.1472 16.6248 29.2607 16.6001 29.3663 16.554C29.4718 16.5079 29.5671 16.4415 29.6469 16.3585C29.7267 16.2755 29.7894 16.1776 29.8313 16.0704C29.8732 15.9632 29.8936 15.8488 29.8913 15.7337C29.8889 15.6186 29.8639 15.5051 29.8176 15.3997C28.2884 11.896 24.8241 9.62351 21.0001 9.625Z" fill="#83BE63"/>
            <path d="M20.9858 2.61216C20.8709 2.61383 20.7574 2.63812 20.6518 2.68366C20.5463 2.72921 20.4507 2.79511 20.3707 2.87759C20.2906 2.96007 20.2275 3.05752 20.1851 3.16437C20.1427 3.27121 20.1218 3.38535 20.1235 3.50029V7.00115C20.1235 7.23328 20.2157 7.45589 20.3799 7.62002C20.544 7.78416 20.7666 7.87637 20.9987 7.87637C21.2308 7.87637 21.4535 7.78416 21.6176 7.62002C21.7817 7.45589 21.8739 7.23328 21.8739 7.00115V3.50029C21.8757 3.38318 21.8539 3.26691 21.8099 3.15836C21.7659 3.04981 21.7006 2.95118 21.6177 2.86836C21.5349 2.78553 21.4363 2.72021 21.3278 2.6762C21.2192 2.63219 21.1029 2.6104 20.9858 2.61216Z" fill="#83BE63"/>
            <path d="M28.8918 4.7244C28.7347 4.72304 28.5801 4.76399 28.4443 4.84298C28.3085 4.92197 28.1965 5.03608 28.1199 5.17331L26.3695 8.20265C26.3078 8.30226 26.2667 8.41325 26.2487 8.52904C26.2307 8.64483 26.2361 8.76307 26.2646 8.87673C26.2932 8.99038 26.3443 9.09716 26.4148 9.1907C26.4854 9.28424 26.5741 9.36263 26.6756 9.42126C26.777 9.47989 26.8892 9.51758 27.0055 9.53203C27.1218 9.54647 27.2398 9.53736 27.3525 9.50533C27.4653 9.4733 27.5704 9.419 27.6617 9.34557C27.7531 9.27213 27.8287 9.18109 27.8842 9.07787L29.6346 6.04852C29.7137 5.91631 29.7564 5.76555 29.7585 5.61152C29.7607 5.45749 29.7221 5.30564 29.6467 5.17129C29.5714 5.03694 29.4619 4.92489 29.3293 4.84642C29.1968 4.76794 29.0458 4.72585 28.8918 4.7244Z" fill="#83BE63"/>
            <path d="M34.6824 10.4956C34.5146 10.4898 34.3487 10.5325 34.2044 10.6184L31.1751 12.3688C31.0718 12.4243 30.9808 12.4999 30.9074 12.5912C30.8339 12.6826 30.7796 12.7877 30.7476 12.9004C30.7155 13.0131 30.7065 13.1311 30.7209 13.2474C30.7353 13.3637 30.773 13.4759 30.8316 13.5774C30.8903 13.6789 30.9687 13.7676 31.0622 13.8382C31.1558 13.9087 31.2625 13.9598 31.3762 13.9883C31.4899 14.0169 31.6081 14.0223 31.7239 14.0043C31.8397 13.9863 31.9507 13.9452 32.0503 13.8835L35.0796 12.133C35.246 12.0396 35.3772 11.8943 35.4533 11.7193C35.5295 11.5443 35.5463 11.3493 35.5013 11.1639C35.4563 10.9784 35.352 10.8128 35.2041 10.6921C35.0563 10.5715 34.8731 10.5025 34.6824 10.4956Z" fill="#83BE63"/>
            <path d="M13.083 4.72426C12.9312 4.73012 12.7835 4.7754 12.6545 4.85566C12.5255 4.93593 12.4196 5.04839 12.3473 5.182C12.2749 5.31561 12.2386 5.46578 12.2419 5.61769C12.2452 5.7696 12.288 5.91804 12.3661 6.04838L14.1165 9.07773C14.172 9.18095 14.2476 9.27195 14.339 9.34538C14.4303 9.41881 14.5354 9.47316 14.6481 9.50519C14.7609 9.53722 14.8789 9.54628 14.9952 9.53184C15.1115 9.51739 15.2237 9.47975 15.3251 9.42112C15.4266 9.36249 15.5152 9.2841 15.5858 9.19056C15.6564 9.09702 15.7075 8.99024 15.736 8.87659C15.7646 8.76293 15.77 8.64469 15.752 8.5289C15.734 8.41311 15.6929 8.30212 15.6312 8.20251L13.8808 5.17317C13.8022 5.032 13.6861 4.91532 13.5453 4.83608C13.4045 4.75685 13.2445 4.71816 13.083 4.72426Z" fill="#83BE63"/>
            <path d="M7.29239 10.4956C7.10379 10.5075 6.92411 10.5802 6.78024 10.7027C6.63636 10.8253 6.53602 10.991 6.49421 11.1753C6.45241 11.3596 6.47139 11.5525 6.54832 11.7251C6.62525 11.8977 6.75599 12.0408 6.92099 12.133L9.95034 13.8834C10.0499 13.9451 10.1609 13.9862 10.2767 14.0043C10.3925 14.0223 10.5108 14.0169 10.6244 13.9883C10.7381 13.9598 10.8449 13.9087 10.9384 13.8381C11.0319 13.7675 11.1104 13.6788 11.169 13.5773C11.2276 13.4759 11.2653 13.3637 11.2797 13.2474C11.2942 13.1311 11.2851 13.0131 11.2531 12.9003C11.221 12.7876 11.1667 12.6825 11.0932 12.5912C11.0198 12.4998 10.9288 12.4242 10.8256 12.3687L7.79621 10.6183C7.64452 10.5274 7.46887 10.4846 7.29239 10.4956Z" fill="#83BE63"/>
        </svg>`,
  logo: `
        <svg xmlns="http://www.w3.org/2000/svg" width="120" height="22" viewBox="0 0 120 22" fill="none">
          <g clip-path="url(#clip0_552_1313)">
            <path d="M6.38852 20.8911C2.59869 20.8911 0.10918 18.7271 0 15.8294H2.00361C2.16393 17.3963 3.32951 19.2947 6.38852 19.2947C9.01377 19.2947 10.557 17.7514 10.557 15.8029C10.557 10.2268 0.163279 13.7462 0.163279 6.6278C0.163279 3.70452 2.57213 1.56616 6.22623 1.56616C9.82623 1.56616 11.9921 3.56977 12.3167 6.16846H10.259C10.0426 4.84157 8.76984 3.21764 6.14459 3.19108C3.92459 3.16256 2.08426 4.38026 2.08426 6.57665C2.08426 12.0445 12.478 8.68747 12.478 15.7242C12.478 18.2953 10.3938 20.894 6.38754 20.894" fill="#393939"/>
            <path d="M27.8538 20.7023H25.9593V18.1006C24.9831 19.9529 23.0145 21.0639 20.9243 20.9423C17.5682 20.9423 14.9154 18.8846 14.9154 14.5537V5.92358H16.7843V14.3413C16.7843 17.6167 18.5705 19.2947 21.2774 19.2947C24.0384 19.2947 25.9603 17.5626 25.9603 13.9626V5.92358H27.8548L27.8538 20.7023Z" fill="#393939"/>
            <path d="M42.1732 12.2571C42.1732 8.98169 40.3869 7.30366 37.68 7.30366C34.9191 7.30366 32.9971 9.03579 32.9971 12.6358V20.7014H31.1027V5.91874H32.9971V8.43579C33.9989 6.61475 35.957 5.53032 38.0322 5.64726C41.3882 5.64726 44.041 7.70497 44.041 12.0358V20.7023H42.1722L42.1732 12.2571Z" fill="#393939"/>
            <path d="M59.7964 1.80908H63.8292L56.8997 20.7022H52.2984L45.3689 1.80908H49.4292L54.6266 16.8317L59.7964 1.80908Z" fill="#393939"/>
            <path d="M70.8954 5.46332C72.8371 5.39807 74.6876 6.28805 75.8488 7.84561V5.70725H79.6652V20.7023H75.8488V18.5099C74.6959 20.0981 72.8302 21.0108 70.8688 20.9463C67.079 20.9463 64.0475 17.8332 64.0475 13.1512C64.0475 8.46922 67.079 5.4643 70.8954 5.4643M71.8691 8.79381C69.839 8.79381 67.918 10.3095 67.918 13.1512C67.918 15.9928 69.8399 17.6177 71.8691 17.6177C73.9534 17.6177 75.8478 16.044 75.8478 13.2063C75.8478 10.3686 73.9534 8.79479 71.8691 8.79479" fill="#393939"/>
            <path d="M86.0823 0.672119H82.2925V20.7023H86.0823V0.672119Z" fill="#393939"/>
            <path d="M102.889 20.7024H99.0728V18.8079C97.9931 20.1645 96.3395 20.9361 94.6063 20.8922C91.1145 20.8922 88.5974 18.6181 88.5974 14.5037V5.70728H92.3873V13.9627C92.3873 16.3715 93.7131 17.6709 95.7168 17.6709C97.7735 17.6709 99.0728 16.3715 99.0728 13.9627V5.70728H102.889V20.7024Z" fill="#393939"/>
            <path d="M112.095 20.9463C107.737 20.9463 104.57 17.9148 104.57 13.2053C104.57 8.46926 107.656 5.46434 112.095 5.46434C114.089 5.36201 116.033 6.1114 117.442 7.5259C118.852 8.9404 119.594 10.8869 119.485 12.8807C119.489 13.3701 119.453 13.859 119.376 14.3424H108.414C108.426 15.2813 108.813 16.1763 109.49 16.8274C110.166 17.4785 111.075 17.8312 112.014 17.8066C113.295 17.8845 114.491 17.1626 115.018 15.9929H119.105C118.183 19.0579 115.292 21.1009 112.095 20.9463ZM108.442 11.7968H115.561C115.533 10.8893 115.136 10.0325 114.462 9.4246C113.787 8.8167 112.894 8.51037 111.989 8.57647C110.138 8.53677 108.58 9.95135 108.442 11.7968Z" fill="#393939"/>
          </g>
          <defs>
            <clipPath id="clip0_552_1313">
              <rect width="120" height="20.6557" fill="white" transform="translate(0 0.672119)"/>
            </clipPath>
          </defs>
        </svg>`,
};

const dataSavings = {
  $50: ["$13,498", "$14,442", "$944"],
  $100: ["$21,785", "$29,464", "$7,679"],
  $150: ["$30,060", "$44,487", "$14,427"],
  $200: ["$38,202", "$59,510", "$21,308"],
  $250: ["$46,503", "$74,533", "$28,03"],
  $300: ["$54,828", "$89,556", "$34,728"],
  $350: ["$63,189", "$104,578", "$41,389"],
  $400: ["$71,569", "$119,601", "$48,032"],
  $450: ["$80,013", "$134,624", "$54,611"],
  $500: ["$88,495", "$149,647", "$61,152"],
  $550: ["$96,977", "$164,670", "$68,075"],
  $600: ["$104,918", "$179,692", "$74,775"],
  $650: ["$113,241", "$194,715", "$81,474"],
  $700: ["$121,565", "$209,738", "$88,173"],
  $750: ["$129,889", "$224,761", "$94,872"],
  $800: ["$138,212", "$239,784", "$101,571"],
};

function handleVisibility(el, eventParams) {
  let isVisible = false;
  let entryTime;
  let visibilityTimer; // Timer to track visibility duration
  const visibilityThreshold = 3000; // 3 seconds in milliseconds
  const config = {
    root: null,
    threshold: 0, // Trigger when any part of the element is out of viewport
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        if (!isVisible) {
          // The element has become visible
          isVisible = true;
          entryTime = new Date().getTime();
          // Set a timer to check visibility duration
          visibilityTimer = setTimeout(
            () => checkVisibilityDuration(),
            visibilityThreshold
          );
        }
      } else if (isVisible) {
        // The element is out of the viewport, clear the timer
        isVisible = false;
        clearTimeout(visibilityTimer);
      }
    });
  }, config);

  const checkVisibilityDuration = () => {
    const exitTime = new Date().getTime();
    const visibilityDuration = exitTime - entryTime;

    if (visibilityDuration >= visibilityThreshold) {
      // The element was visible for more than 3 seconds
      const eventData = eventParams;
      eventData[1] = visibilityDuration / 1000; // Convert to seconds
      pushDataLayer(eventData);
      observer.disconnect();
    }
  };

  observer.observe(el);
}

function pushDataLayer([event_name, event_desc, event_type, event_loc]) {
  // Send a Google Analytics event
  const eventData = {
    event: "event-to-ga4",
    event_name,
    event_desc,
    event_type,
    event_loc,
  };

  window.dataLayer = window.dataLayer || [];
  dataLayer.push(eventData);
  console.log(
    event_name + " / " + event_desc + " / " + event_type + " / " + event_loc
  );
}

function roundToNearestMultiple(number) {
  // Визначення множника
  const multiple = number < 100 ? 5 : 50;

  // Округлення до найближчого більшого числа, кратного множнику
  return Math.ceil(number / multiple) * multiple;
}

let viewedOne = false;
let viewedTwo = false;
let viewedTree = false;
let viewedFour = false;
let viewedFive = false;
let viewedSeven = false;
let viewedEight = false;
let viewedUtilprov = false;

let clickRadioNext = false;

function visibleAfterTimer() {
  setTimeout(() => {
    if (
      viewedOne == false &&
      $(".swiper-slide").eq(0).hasClass("swiper-slide-active")
    ) {
      viewedOne = true;
      pushDataLayer([
        "exp_valu_prop_vis_discov_full",
        "Full page view",
        "Visibility",
        "Discover Incentive Program in City",
      ]);
    }
    if (
      viewedTwo == false &&
      $(".swiper-slide").eq(1).hasClass("swiper-slide-active")
    ) {
      viewedTwo = true;
      pushDataLayer([
        "exp_valu_prop_vis_energybill_full",
        "Full page view",
        "Visibility",
        "How much is your monthly energy bill?",
      ]);
    }
    if (
      viewedUtilprov == false &&
      $(".swiper-slide").eq(2).hasClass("swiper-slide-active")
    ) {
      viewedUtilprov = true;
      pushDataLayer([
        "exp_valu_prop_vis_utilprov_full",
        "Full page view",
        "Visibility",
        "Who is your utility provider?",
      ]);
    }
    if (
      viewedTree == false &&
      $(".swiper-slide").eq(3).hasClass("swiper-slide-active")
    ) {
      viewedTree = true;
      pushDataLayer([
        "exp_valu_prop_vis_findroof_full",
        "Full page view",
        "Visibility",
        "Find your roof",
      ]);
    }
    if (
      viewedFour == false &&
      $(".swiper-slide").eq(4).hasClass("swiper-slide-active")
    ) {
      viewedFour = true;
      pushDataLayer([
        "exp_valu_prop_vis_sunlight_full",
        "Full page view",
        "Visibility",
        "Does Your Roof Get Sunlight?",
      ]);
    }
    if (
      viewedFive == false &&
      $(".swiper-slide").eq(5).hasClass("swiper-slide-active") &&
      $(".slide-active-analyzing").length > 0
    ) {
      viewedFive = true;
      pushDataLayer([
        "exp_valu_prop_vis_analyz_full",
        "Full page view",
        "Visibility",
        "Analyzing provided information",
      ]);
      pushDataLayer([
        "exp_valu_prop_vis_analyz_bill",
        "Your Latest Energy Bill",
        "Visibility",
        "Analyzing provided information",
      ]);
      pushDataLayer([
        "exp_valu_prop_vis_analyz_numb",
        "Recommended Number of Panels",
        "Visibility",
        "Analyzing provided information",
      ]);
      pushDataLayer([
        "exp_valu_prop_vis_analyz_partne",
        "City Solar Partners",
        "Visibility",
        "Analyzing provided information",
      ]);
      pushDataLayer([
        "exp_valu_prop_vis_analyz_savin",
        "Estimated 20-Year Savings",
        "Visibility",
        "Analyzing provided information",
      ]);

      setTimeout(() => {
        pushDataLayer([
          "exp_valu_prop_vis_emailaddres_full",
          "Full page view",
          "Visibility",
          "What is your email address?",
        ]);

        pushDataLayer([
          "exp_valu_prop_vis_emailaddres_text",
          "Text",
          "Visibility",
          "What is your email address?",
        ]);
      }, 7500);
    }

    if (
      viewedSeven == false &&
      $(".swiper-slide").eq(6).hasClass("swiper-slide-active")
    ) {
      viewedSeven = true;
      pushDataLayer([
        "exp_valu_prop_vis_youname_full",
        "Full page view",
        "Visibility",
        "What is your name?",
      ]);

      pushDataLayer([
        "exp_valu_prop_vis_youname_text",
        "Text",
        "Visibility",
        "What is your name?",
      ]);
    }

    if (
      viewedEight == false &&
      $(".swiper-slide").eq(7).hasClass("swiper-slide-active")
    ) {
      viewedEight = true;
      pushDataLayer([
        "exp_valu_prop_vis_onestep_full",
        "Full page view",
        "Visibility",
        "One step before the finish line",
      ]);
      pushDataLayer([
        "exp_valu_prop_vis_onestep_text",
        "Text",
        "Visibility",
        "One step before the finish line",
      ]);
    }
  }, 3000);
}

class changeFlow {
  constructor(device) {
    this.device = device;
    this.startTime = 0;
    this.startTimeInterval;
    this.init();
  }

  init() {
    this.styleAppend();

    if (this.checkPageUrl() == "save") {
      this.updateRangeSlider();
      this.changeSlides();
      this.addSlideAnalyzing();

      $(".custom-radio input").click(function () {
        console.log("click radio");
        $(".wrapper").addClass("slide-active-analyzing");

        setTimeout(() => {
          $(".wrapper").removeClass("slide-active-analyzing");
        }, 7500);
      });
      document.body.insertAdjacentHTML(
        "afterbegin",
        `
      <style>
        .site-footer {
          display: none!important;
        }
      </style>`
      );
    } else {
      this.addThankPage();
    }

    const globalMutation = new MutationObserver((mutations) => {
      //add data in Storange for thank you page
      if (
        this.checkPageUrl() == "save" &&
        $(".swiper-slide").eq(7).hasClass("swiper-slide-active")
      ) {
        $(".wrapper").addClass("active-last-slide");

        let data = {};
        data.price = $(".rangeslider-tooltip").text();
        data.city = $(".htitle").text().split("in")[1];
        data.partners = "";
        data.lastInfo == "";

        localStorage.setItem("crs_data", JSON.stringify(data));
      } else {
        $(".wrapper").removeClass("active-last-slide");
      }

      //change address-error text
      if ($("#address-error").html() !== "") {
        $("#address-error").html(
          "Your address should contain both letters and numbers"
        );
      }
      //change Family name error text
      if ($("#lname-error").html() !== "") {
        $("#lname-error").html("Please Enter Your Family Name");
      }

      //hide next btn for 2 and 4 slide (desktop)
      if (!media && this.checkPageUrl() == "save") {
        if (
          $(".swiper-slide").eq(2).hasClass("swiper-slide-active") ||
          $(".swiper-slide").eq(4).hasClass("swiper-slide-active")
        ) {
          $("#slider-block .default").attr("style", "display: none!important;");
        } else {
          $("#slider-block .default").attr("style", "");
        }
      }

      //events
      if ($(".swiper-slide").eq(0).hasClass("swiper-slide-active")) {
        visibleAfterTimer();
      } else {
        viewedOne = false;
      }

      if ($(".swiper-slide").eq(1).hasClass("swiper-slide-active")) {
        visibleAfterTimer();
      } else {
        viewedTwo = false;
      }
      if (
        $(".swiper-slide").eq(2).hasClass("swiper-slide-active") &&
        clickRadioNext == false
      ) {
        clickRadioNext = true;
        $(".swiper-slide:nth-child(3) .radioNext input").change(function (e) {
          let spt = $(this).val().trim().split(" ");
          let eventName = $(this)
            .val()
            .includes("Los Angeles Department of Water & Power")
            ? "angdep"
            : $(this).val().includes("Glendale Water & Power")
            ? "watpow"
            : $(this).val().includes("Other")
            ? "other"
            : spt[spt.length - 1].toLowerCase();

          pushDataLayer([
            "exp_valu_prop_but_utilprov_" + eventName,
            $(this).val(),
            "Button",
            "Who is your utility provider?",
          ]);
        });
      }
      if ($(".swiper-slide").eq(2).hasClass("swiper-slide-active")) {
        visibleAfterTimer();
      } else {
        viewedUtilprov = false;
      }
      if ($(".swiper-slide").eq(3).hasClass("swiper-slide-active")) {
        visibleAfterTimer();
      } else {
        viewedTree = false;
      }
      if ($(".swiper-slide").eq(4).hasClass("swiper-slide-active")) {
        visibleAfterTimer();
      } else {
        viewedFour = false;
      }

      if (
        $(".swiper-slide").eq(5).hasClass("swiper-slide-active") &&
        $(".slide-active-analyzing").length > 0
      ) {
        visibleAfterTimer();
      } else {
        viewedFive = false;
      }

      if ($(".swiper-slide").eq(7).hasClass("swiper-slide-active")) {
        visibleAfterTimer();
      } else {
        viewedEight = false;
      }

      globalMutation.disconnect();

      globalMutation.observe(document.body, {
        childList: true,
        subtree: true,
      });
    });

    globalMutation.observe(document.body, {
      childList: true,
      subtree: true,
    });
  }

  checkPageUrl() {
    const pageUrl = window.location.href;

    if (pageUrl.includes("/save")) {
      return "save";
    } else if (pageUrl.includes("/thankyou")) {
      return "thankyou";
    } else {
      return "other";
    }
  }

  styleAppend() {
    const style = /* html    */ `
        <style class="crs-style">
           .banner-slider .swiper-slide:nth-child(2) h4 {
              opacity: 0;
              pointer-events: none;
              position: absolute;
            } 
            
            .wrapper:not(.active-last-slide) .crs_submit,
            .wrapper.active-last-slide #slider-block .default:not(.crs_submit),
            .banner,
            .final-btn,
            .slide-active-analyzing.wrapper .swiper-slide-analyzing + .container,
            .wrapper:not(.slide-active-analyzing) .swiper-slide-analyzing {
                display: none!important;
            }
            .slide-active-analyzing.wrapper .btn-block {
                opacity: 0;
                pointer-events: none;
            }
            .steps-wrapper {
                display: block;
            }
            .text-nowrap {
              text-wrap: nowrap;
            }
            input {
                font-size: 16px!important;
                padding: 16px!important;
            }
            .form-list input {
                line-height: 28px!important;
            }
            input::-webkit-input-placeholder {
                color: #757575;
                font-size: 16px;
                font-weight: 350;
                line-height: 28px;
            }
            input::-moz-placeholder {
                color: #757575;
                font-size: 16px;
                font-weight: 350;
                line-height: 28px;
            }
            input:-ms-input-placeholder {
                color: #757575;
                font-size: 16px;
                font-weight: 350;
                line-height: 28px;
            }
            input:-moz-placeholder {
                color: #757575;
                font-size: 16px;
                font-weight: 350;
                line-height: 28px;
            }

            .btn.crs_submit {
              border-radius: 5px;
              color: #FFF;
              text-align: center;
              font-size: 16px;
              font-style: normal;
              font-weight: 700;
              line-height: 24px; /* 150% */
              letter-spacing: 0.5px;
              text-transform: uppercase;
              background: #83BE63;
              margin-left: auto;
            }
            .wrapper .input-error + .error-msg {
                display: block!important;
                padding: 0;
            }
            .wrapper .title,
            .wrapper h5,
            .wrapper h4,
            #tcpa_label {
                text-align: left;
            }
            #tcpa_label {
                color: #757575;
            }
            .wrapper .container h2 {
                font-size: 24px!important;
                margin-bottom: 16px!important;
                text-transform: lowercase;
            } 
            .wrapper .container h2::first-letter {
                text-transform: uppercase;
            }
            .wrapper .form-list {
                margin-top: 16px;
                max-width: 100%;
            }
            .wrapper .form-list li, .wrapper .form-list li.full {
                margin: 0 0 16px 0;
                width: 100%;
            }
            .wrapper .form-list a.btn {
                margin-top: 9px;
            }
            .swiper-wrapper {
                height: auto!important;
            }
            .wrapper {
                padding: 106px 0 0 0!important;
            }
            .banner-slider .swiper-slide.one {
                margin-top: -54px;
            }
            .wrapper .banner-slider {
                overflow: visible;
            }
            .wrapper .progress-block {
                top: 60px!important;
            }
            .wrapper .progress-block p {
                color: #393939;
                margin-top: 6px;
            }
            .swiper-wrapper .swiper-slide:nth-child(2) .crs_block {
                align-items: center;
            }
            #bill-buttons {
                padding: 0!important;
            }
            .crs_block {
                border-radius: 8px;
                background: #427596;
                padding: 12px;
                display: flex;
                margin-bottom: 16px;
            }
            .crs_block svg {
                margin-right: 12px;
                flex-shrink: 0;
            }
            .crs_block p {
                color: #FFF;
                font-size: 16px;
                font-style: normal;
                font-weight: 500;
                line-height: 24px; 
                text-align: left;
            }
            .wrapper #slider-block {
                position: fixed;
                bottom: 0;
                left: 0;
                border-top: 1px solid #E0E4EB;
                background: #EDF2F5;
                padding: 12px 20px;
                z-index: 3;
                min-height: 81px;
            }
            .wrapper #slider-block .btn {
                width: 200px;
                padding: 16px;
            }
            .wrapper .back-link::before {
                top: 0;
                width: 19px;
            }
            .wrapper .back-link {
                padding-left: 27px;
            }
            #companies>div, #bill-buttons>div {
                font-size: 16px;
                line-height: 24px;
                letter-spacing: 0.5px;
                text-transform: uppercase;
                padding: 12px;
                min-height: 56px;
                max-width: 100%;
                font-weight: 700;
            }
            .underline {
                text-decoration: underline;
            }
            .c-yellow {
              color: #FFD125;
            }
            .crs_list_info {
                padding-bottom: 4px;
            }
            .crs_list_info li {
                display: flex;
                align-items: center;
                text-align: left;
                margin: 0 0 12px 0;
            }
            .crs_list_info li svg {
                flex-shrink: 0;
                margin-right: 12px;
            }
            .crs_list_info li p {
                color: #2B3D50;
                font-size: 16px;
                font-style: normal;
                font-weight: 500;
                line-height: 24px; /* 150% */
            }
            .wrapper .vsmall-container {
              max-width: 100%;
            }
            .wrapper h1, .wrapper h2 {
              font-size: 24px!important; 
            }
            @media (max-width: 769px) {
              .wrapper:not(.slide-active-analyzing,.show)::before {
                background-position: center bottom 81px;
              }
            }
            @media (min-width: 770px) {
              .d-md-none {
                display: none!important;
              }
              #next-block {
                opacity: 0;
              }
              .wrapper .banner-slider {
                width: 100%;
              }
              .banner-slider .swiper-slide {
                left: 50%;
                width: 100%!important;
                transform: translateX(-50%)!important;
                position: absolute;
              }
              .wrapper {
                align-items: flex-start;
              }
              .wrapper .container {
                max-width: 600px;
              }
              .wrapper .form-list {
                max-width: 100%;
              }
              .wrapper h1,
              .wrapper .container h2 {
                font-size: 36px!important;
                font-style: normal;
                font-weight: 700;
                line-height: 44px; 
              }
              .wrapper .container h2 {
                margin-bottom: 26px!important;
              }
              .wrapper h4,
              .wrapper h5 {
                font-size: 16px!important;
                font-weight: 400!important;
              }
              .banner-slider .v-center {
                padding-top: 60px;
                top: 0;
                -webkit-transform: translateY(0);
                transform: translateY(0);
              }
              .banner-slider .swiper-slide.one .v-center {
                padding-top: 128px
              }
              .crs_block svg {
                height: 48px;
              }
              .banner-slider .swiper-slide.one {
                width: 100%!important;
              }
              .site-header {
                padding: 27px 0;
              }
              .wrapper .progress-block {
                top: 84px!important;
              }
              .wrapper #slider-block a:not(.back-link) {
                width: 300px!important;
                border-radius: 5px;
                padding: 16px;
                background: #83BE63;
                color: #FFF;
                text-align: center;
                font-size: 16px;
                font-style: normal;
                font-weight: 700;
                line-height: 24px; /* 150% */
                letter-spacing: 0.5px;
                text-transform: uppercase;
                margin-left: auto;
              }
              .wrapper:not(.active-last-slide) #slider-block .default:not(.crs_submit) {
                display: block!important;
              }
              #slider-block {
                max-width: 540px;
                width: 100%!important;
                left: 50%!important;
                bottom: 5.83vh!important;
                transform: translateX(-50%);
                border-radius: 8px;
                border-top: 1px solid #E0E4EB;
                background: #EEF3F6!important;
                padding: 12px!important;
              }
              .wrapper .sliderLegend .sliderLegendItem--start, .wrapper .footage .sliderLegend .sliderLegendItem--start {
                left: 0;
                font-size: 18px;
              }
              .wrapper .sliderLegend .sliderLegendItem--end, .wrapper .footage .sliderLegend .sliderLegendItem--end {
                right: 0;
                font-size: 18px;
              }
              .wrapper .rangeslider-block {
                padding-top: 45px;
                margin-top: 0;
              }
              #companies>div, 
              #bill-buttons>div {
                width: 100%;
                max-width: 100%;
                margin: 0 0 12px 0;
                border-radius: 5px;
                border: 1px solid #FFF;
                background: #83BE63;
                padding: 23px 12px;
                font-weight: 700;
              }
              .wrapper .text-field,
              .wrapper .form-list a.btn {
                border-radius: 5px;
              }
              .wrapper .custom-radio.borderd.with-img .custom-radio-item {
                margin: 0 20px 10px 0;
                width: calc(50% - 10px);
                display: block;
              }
              .wrapper .custom-radio.borderd.with-img .custom-radio-item:nth-child(2n+2) {
                margin-right: 0;
              }
              .wrapper .custom-radio.borderd {
                display: flex;
                flex-wrap: wrap;
              }
              .wrapper .btn-block .back-link {
                left: 16px!important;
              }
            }
        </style>
    `;

    $("body").prepend(style);
  }

  addBlock(index, icon, text) {
    const block = `
    <div class="crs_block">
        ${icon}
        <p>${text}</p>
    </div>`;

    $(".swiper-slide").eq(index).find(".container").prepend(block);
  }

  changeSlides() {
    const self = this;

    //add submit btn for last step
    $("#next-block .nextSlide").after(
      `<a href="#" class="btn crs_submit">SUBMIT</a>`
    );
    $("#slider-block .nextSlide").after(
      `<a href="#" class="btn crs_submit">SUBMIT</a>`
    );
    $(".crs_submit").click(function () {
      pushDataLayer([
        "exp_valu_prop_but_onestep_nex",
        "Submit",
        "Button",
        "One step before the finish line",
      ]);
      $("#submit").click();
    });

    //events
    let clickCount = 0;
    $("#slider-block .default").click(function (e) {
      if ($(".swiper-slide").eq(2).hasClass("swiper-slide-active")) {
        pushDataLayer([
          "exp_valu_prop_but_energybill_next",
          $(".rangeslider-tooltip").text() + " - Next",
          "Button",
          "How much is your monthly energy bill?",
        ]);
      }
      if ($(".swiper-slide").eq(4).hasClass("swiper-slide-active")) {
        pushDataLayer([
          "exp_valu_prop_but_findroof_next",
          "Next",
          "Button",
          "Find your roof",
        ]);
      }
      if ($(".swiper-slide").eq(6).hasClass("swiper-slide-active")) {
        pushDataLayer([
          "exp_valu_prop_but_emailaddres_nex",
          "Next",
          "Button",
          "What is your email address?",
        ]);
      }
      if ($(".swiper-slide").eq(7).hasClass("swiper-slide-active")) {
        pushDataLayer([
          "exp_valu_prop_but_youname_next",
          "Next",
          "Button",
          "What is your name?",
        ]);
      }
      //hide error message 1 entry
      if (!media) {
        // e.preventDefault();
        // $("#next-block .nextSlide").click();

        if (
          $(".swiper-wrapper .swiper-slide")
            .eq(6)
            .hasClass("swiper-slide-active") &&
          clickCount == 0
        ) {
          clickCount = 1;
          $(".swiper-wrapper .swiper-slide")
            .eq(6)
            .find(".input-error")
            .removeClass("input-error");
          $(".swiper-wrapper .swiper-slide").eq(6).find(".error-msg").html("");
        }
        if (
          $(".swiper-wrapper .swiper-slide")
            .eq(7)
            .hasClass("swiper-slide-active") &&
          clickCount == 1
        ) {
          clickCount = 2;
          $(".swiper-wrapper .swiper-slide")
            .eq(7)
            .find(".input-error")
            .removeClass("input-error");
          $(".swiper-wrapper .swiper-slide").eq(7).find(".error-msg").html("");
        }
      }
    });
    $(".back-link").click(function () {
      let title = $(".swiper-slide-next .title").eq(1).text();
      title = title.includes("By providing your")
        ? "One step before the finish line"
        : title;
      let eventName = title.includes("How much is you")
        ? "energybill"
        : title.includes("Who is your utility")
        ? "utilprov"
        : title.includes("Find your roof")
        ? "findroof"
        : title.includes("Does Your Roof Get")
        ? "sunlight"
        : title.includes("What is your name")
        ? "youname"
        : title.includes("email address")
        ? "emailaddres"
        : "onestep";

      pushDataLayer([
        `exp_valu_prop_but_${eventName}_back`,
        "Back",
        "Button",
        title,
      ]);
    });
    const zip = $("#zip").val();
    $("#zip").change(function (e) {
      if (zip != $(this).val()) {
        console.log($(this).val());
        clickRadioNext = false;
      }
    });

    $("#tcpa_label a").click(function (e) {
      pushDataLayer([
        "exp_valu_prop_lin_onestep_solpart",
        "4 solar partners",
        "Link",
        "One step before the finish line",
      ]);
    });

    $("#autoaddress").change(function () {
      pushDataLayer([
        `exp_valu_prop_inp_findroof_infor`,
        "information",
        "Input",
        "Find your roof Check how much",
      ]);
    });

    $(".swiper-slide:nth-child(5) .radioNext input").change(function () {
      let eventName = $(this).parent().text().includes("Some")
        ? "shade"
        : $(this).parent().text().includes("Sunlight")
        ? "full"
        : $(this).parent().text().includes("Severe")
        ? "severe"
        : "uncer";

      let eventDesk = $(this).parent().text().includes("Some")
        ? "Some Shade"
        : $(this).parent().text().includes("Sunlight")
        ? "Full Sunlight"
        : $(this).parent().text().includes("Severe")
        ? "Severe Shade"
        : "Uncertain";

      pushDataLayer([
        "exp_valu_prop_but_sunlight_" + eventName,
        eventDesk,
        "Button",
        "Does Your Roof Get Sunlight?",
      ]);
    });
    $(".swiper-wrapper .swiper-slide:nth-child(6) input").change(function () {
      pushDataLayer([
        "exp_valu_prop_inp_emailaddres_emai",
        "Email",
        "Input",
        "What is your email address? We have a strict spam-free privacy policy",
      ]);
    });
    $(".swiper-wrapper .swiper-slide:nth-child(7) input").change(function (e) {
      let eventName = $(this).attr("placeholder").includes("First Name")
        ? "firs"
        : "fami";
      let eventDesk = eventName == "firs" ? "First" : "Family";

      pushDataLayer([
        "exp_valu_prop_inp_youname_" + eventName,
        eventDesk + " Name",
        "Input",
        "What is your name?",
      ]);
    });
    $(".swiper-wrapper .swiper-slide:nth-child(8) input").change(function () {
      pushDataLayer([
        "exp_valu_prop_inp_onestep_phone",
        "Enter your mobile phone number",
        "Input",
        "One step before the finish line",
      ]);
    });

    //change slides
    $(".swiper-wrapper .swiper-slide").each(function (index, element) {
      let _this = $(element);

      if (index == 0) {
        _this.find("h1.title").html(`Discover Incentive  <br class="d-md-none">
            Program in ${
              _this.find("h1.title").html().split("City")[0].split("Solar")[0]
            }`);

        _this.find("h5").html("Enter Zip Code below:");
        _this.find("a.btn > span").html("Discover Incentive Program");

        self.addBlock(
          index,
          dataIcons.settings,
          "SunValue will assist you in verifying the availability of your address for the Incentive Program"
        );

        _this.find("#calculateYourSavings").click(function () {
          pushDataLayer([
            "exp_valu_prop_but_discov_next",
            "Discover Incentive Program",
            "Button",
            "Discover Incentive Program in City",
          ]);
        });
        dataState.then((data) => {
          let stringData = JSON.stringify(data);
          let findCity = stringData.split(
            '"' + _this.find("h1.title").text().split("in")[1].trim()
          )[0];
          let findZipCodes = findCity.split('"zip_code":');
          let zipCode = findZipCodes[findZipCodes.length - 1].split(",")[0];

          const inputElement = document.querySelector("input#zip");
          inputElement.value = zipCode;
          inputElement.dispatchEvent(new Event("input", { bubbles: true }));
        });
      } else if (index == 1) {
        self.addBlock(
          index,
          dataIcons.location,
          "Incentives are found in your area!"
        );
      } else if (index == 3) {
        _this.find("h2").html("Find your roof");
        _this
          .find("h4")
          .html(
            "Check how much sunlight your property receives to determine savings"
          );
      } else if (index == 5) {
        _this
          .find(".sub-title ")
          .html("We have a strict spam-free privacy policy");
        _this.find("#email").attr("placeholder", "Enter your email");
      } else if (index == 6) {
        _this.find("h2").html("What is your name?");
        _this.find("#fname").attr("placeholder", "First Name");
        _this.find("#lname").attr("placeholder", "Family Name");
      } else if (index == 7) {
        _this
          .find("h2")
          .html(
            "By providing your number, our partners can contact you shortly with:"
          );
        _this.find(".sub-title").hide();

        _this
          .find("#phone")
          .attr("placeholder", "Enter your mobile phone number");
        _this
          .find("h2")
          .attr("style", `font-size: 16px!important; line-height: 26px;`);
        _this.find("h2.mb-5 ").after(`<ul class="crs_list_info">
            <li>${dataIcons.certificate}
                <p>Status of your qualification for the Solar Incentive Program</p>
            </li>
            <li>${dataIcons.solarenergy}
                <p>Your solar energy system size and solar energy savings predictions</p>
            </li>
        </ul>`);
      }

      if (index == 5 || index == 6) {
        self.addBlock(
          index,
          dataIcons.info,
          `Provide your contact details for an immediate <span class="c-yellow">free</span> solar quote and qualification status information`
        );
      }
    });
  }

  updateRangeSlider() {
    const rangeBlock = `
        <input type="range" min="50" value="350" max="800" step="50" value="100" name="monthly_elec" data-rangeslider>
        <div class="rangeslider-tooltip">$<output>50</output></div>
        <div class="sliderLegend">
            <p class="sliderLegendItem--start">$50</p>
            <p class="sliderLegendItem--end">$800+</p>
        </div>
    `;
    // Get the rangeslider instance
    let slider = $("#bill-slider");
    slider.html(rangeBlock);

    let changeSlider = 0
    $("[data-rangeslider]").change(function (e) {
      if (changeSlider == 1) {
        const price = e.target.value;
        $(".crs_analyzing li:first-child b").html(
          $(".rangeslider-tooltip").text()
        );
        $(".crs_analyzing li:nth-child(2) span").html((price / 50) * 8);
  
        pushDataLayer([
          "exp_valu_prop_range_energybill_slider",
          "Slider",
          "Range slider",
          "How much is your monthly energy bill?",
        ]);
      }
      changeSlider = 1
    });

    initRangeSlider();
  }

  addAnalyzedInfo(data) {
    const price = data.price ? data.price.replace("+", "") : "$50",
      city = data.city,
      panels = (parseFloat(price.replace(price[0], "")) / 50) * 8,
      costWit = dataSavings[price][0],
      costWithout = dataSavings[price][1],
      toPrice = roundToNearestMultiple(
        parseFloat(costWithout.replace(costWithout[0], "").split(",")[0])
      ),
      fromPrice = Math.round(toPrice / 2),
      partners =
        data.partners == "loader"
          ? `
          <li>
              <p>${city} Solar Partners</p>
              <p class="flex-center">${dataIcons.loader}<b>Searching for partners nearby</b></p>
          </li>`
          : `
          <li>
              <p>Estimated 20-Year Savings</p>
              <p><b>${dataSavings[price][2]}</b></p>
          </li>`,
      lastInfo =
        data.lastInfo == "loader"
          ? `<p>Estimated 20-Year Savings</p> 
          <p class="flex-center">${dataIcons.loader}<b>Analyzing your responses</b></p>`
          : `
        <h3>20-Year cost analysis with and <span class="text-nowrap">without solar</span></h3>
        <div class="crs_graphic">
            <div>
                <p><b>Total 20-year cost without solar</b></p>
                <div class="crs_graphic_line navy" style="width: ${
                  (100 *
                    parseFloat(
                      costWithout.replace(costWithout[0], "").split(",")[0]
                    )) /
                  toPrice
                }%"><span>${costWithout}</span></div>
            </div>
            <div>
                <p><b>Total 20-year cost with solar</b></p>
                <div class="crs_graphic_line green" style="width: ${
                  (100 *
                    parseFloat(costWit.replace(costWit[0], "").split(",")[0])) /
                  toPrice
                }%"><span>${costWit}</span></div>
            </div>
        </div>
        <div class="crs_graphic_pins">
            <div>$0</div>
            <div>$${fromPrice},000</div>
            <div>$${toPrice},000</div>
        </div>`;

    return `
    <style>
        .crs_analyzing {
          padding: 0;
        }
        .crs_analyzing li {
            border-radius: 5px;
            background: #FFF;
            margin: 0 0 12px 0;
            padding: 10px;
            list-style-type: none;
        } 
        .crs_analyzing p {
            color: #4A4A4A;
            text-align: center;
            font-size: 16px;
            font-style: normal;
            font-weight: 400;
            line-height: 24px;
            margin: 0;
        } 
        .crs_analyzing p b {
            color: #427596;
            font-size: 14px;
            font-weight: 700;
            line-height: 24px;
        }
        .crs_analyzing p:not(.flex-center) b {
            font-size: 24px;
            line-height: 36px;
        }
        .crs_analyzing p svg {
            flex-shrink: 0;
            margin-right: 8px;
            margin-top: 6px;
        }
        .crs_analyzing p span {
            padding-right: 5px;
        }
        .crs_analyzing p:first-child {
          margin-bottom: 4px;
        }
        .flex-center {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .crs_graphic {
            border-left: 2px solid #D9D9D9;
            border-bottom: 2px solid #D9D9D9;
            width: calc(100% - 16px);
            margin: 0 auto;
        }
        .crs_graphic p,
        .crs_thank .crs_analyzing .crs_graphic b {
            color: #4A4A4A;
            font-size: 12px;
            font-style: normal;
            font-weight: 700;
            line-height: 20px; 
            padding: 0 8px 4px;
            text-align: left;
        }
        .crs_graphic_line {
            height: 42px;
            flex-shrink: 0; 
            margin-bottom: 6px;
        }
        .crs_graphic_line span {
          display: block;
          text-align: right;
          line-height: 42px;
          color: #FFF;
          font-family: 'Noto Sans SC', sans-serif;
          font-size: 12px;
          font-style: normal;
          font-weight: 700;
          padding: 0 4px;
        }
        .crs_graphic_line.navy {
            background: #427596;
            margin-bottom: 10px;
        }
        .crs_graphic_line.green {
            background: #83BE63;
        }
        .crs_graphic_pins {
            display: flex;
            justify-content: space-between;
            color: #4A4A4A;
            font-size: 12px;
            font-style: normal;
            font-weight: 400;
            line-height: 20px; 
            position: relative;
            width: calc(100% - 16px);
            margin: 0 auto;
        }
        .crs_graphic_pins > div {
          width: 100%;
        }
        .crs_graphic_pins > div:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 3px;
            background: #D9D9D9; 
        }
        .crs_graphic_pins > div:last-child {
          text-align: right;
        }
        .crs_graphic_pins > div:last-child:before {
            left: auto;
            right: 0;
        }
        .crs_graphic_pins > div:nth-child(2) {
          text-align: center;
        }
        .crs_graphic_pins > div:nth-child(2):before {
            left: 50%;
            transform: translateX(-50%);
        }
        .crs_analyzing h3 {
          color: #4A4A4A;
          font-family: 'Noto Sans SC', sans-serif;
          font-size: 16px;
          font-style: normal;
          line-height: 24px;
        }
        @media (min-width: 770px) {
          .crs_analyzing h3 {
            margin: 0 0 24px 0;
          }
          .crs_analyzing li:last-child {
            padding: 24px 30px;
          }
          .crs_graphic {
            width: 100%;
          }
          .crs_graphic_pins {
            padding-top: 3px;
          }
        }
    </style>
    <ul class="crs_analyzing">
        <li>
            <p>Your Latest Energy Bill</p>
            <p><b>${price + (price.includes("800") ? "+" : "")}</b></p>
        </li>
        <li>
            <p>Recommended Number of Panels</p>
            <p><b><span>${panels}</span>panels 350W/panel</b></p>
        </li>
        ${partners}
        <li>
          ${lastInfo}
        </li>
       
    </ul>`;
  }

  addSlideAnalyzing() {
    let data = {};
    data.city = $(".swiper-wrapper .swiper-slide")
      .eq(0)
      .find("h1.title")
      .html()
      .split("in")[1];
    data.partners = "loader";
    data.lastInfo = "loader";

    const newSlide = `
        <div class="swiper-slide-analyzing">
            <div class="container text-center">
                <h2 class="title">Analyzing provided information</h2>
                ${this.addAnalyzedInfo(data)}
            </div>
        </div>`;

    $(".swiper-wrapper .swiper-slide .container").eq(5).before(newSlide);
  }

  addThankPage() {
    const data = JSON.parse(localStorage.getItem("crs_data"));

    const page = `
    <style>
        .main-title {
            display: none;
        }
        .steps-wrapper:before {
          content: none;
        }
        .site-header .lock {
          background: #83be63 url(/images/lock-white.svg) center center no-repeat;
        }
        .steps-wrapper,
        .step-page .site-header  {
          background: #EDF2F5;
          border: none;
        }
        .crs_thank {
            padding: 12px 0;
        }
        .crs_thank h2 {
            color: #4A4A4A;
            font-size: 24px;
            font-style: normal;
            font-weight: 700;
            line-height: 34px;
            font-family: 'Noto Sans SC', sans-serif;
            margin-bottom: 12px;
        }
        .crs_thank p,
        .crs_thank_list li,
        .crs_thank_list li:before  {
          color: #4A4A4A;
          font-family: 'Noto Sans SC', sans-serif;
          font-size: 16px;
          font-style: normal;
          line-height: 24px;
        }
        .crs_thank_list {
          list-style-type: none;
          padding: 0;
        }
        .crs_thank_list li {
          padding: 0 0 16px 48px;
          font-weight: 500;
          position: relative;
          min-height: 52px;
        }
        .crs_thank_list li:last-child {
          padding: 0 0 0 0 48px;
        }
        .crs_thank_list li:before {
          content: attr(data-num);
          font-weight: 500;
          line-height: 32px;
          width: 36px;
          height: 36px;
          flex-shrink: 0;
          margin-right: 12px;
          border: 2px solid #83BE63;
          text-align: center;
          border-radius: 50%;
          position: absolute;
          left: 0;
          top: 0;
        }
        .crs_thank_list li:first-child:after {
          content: '';
          height: calc(100% - 40px);
          width: 0;
          border-right: 2px dashed #83BE63;
          left: 18px;
          bottom: 2px;
          position: absolute;
        }
        .crs_thank .crs_analyzing p b {
          font-size: 24px;
          line-height: 36px;
        }
        .crs_analyzing li:last-child {
          padding: 16px;
        }

        .site-footer {
          margin: 0 -15px;
        }
        p.crs_text {
          color: #757575;
          font-family: 'Noto Sans SC', sans-serif;
          font-size: 12px;
          font-style: normal;
          font-weight: 350;
          line-height: normal;
          padding: 10px 0;
        }
        p.crs_text a {
          text-decoration: underline;
          color: #757575;
          font-family: 'Noto Sans SC', sans-serif;
        }
        @media (min-width: 770px) {
          .crs_thank_list li:first-child  {
            display: flex;
            align-items: center;
            padding-bottom: 24px;
            min-height: 60px;
          }
          .steps-wrapper .container {
            max-width: 540px;
            padding: 0;
          }
        }
    </style>
    <div class="crs_thank">
        <div class="container">
            <h2 class="title">You'll be contacted by a Solar Expert Partner in ${
              data.city
            } within a couple of hours</h2>
            <p><b>Next steps:</b></p>
            <ul class="crs_thank_list">
                <li data-num="1">One of our Solar Expert Partners will call you shortly</li>
                <li data-num="2">During the call, you will learn if your home qualifies for solar incentives, the suggested solar system size, and your predicted solar energy savings</li>
            </ul>
            <p><b>Your estimated solar system savings</b></p>
            ${this.addAnalyzedInfo(data)}
            <p class="crs_text">These numbers are just estimates according to our <span class="text-nowrap">marketplace <a href="https://sunroof.withgoogle.com">research</a></span>. For a more exact estimate, please talk <span class="text-nowrap">to one</span> of our experts as savings can vary depending on roof type, sun exposure, electrical utility, etc.<p>
        </div>
    </div>
    `;

    $(".logo").html(dataIcons.logo);
    $(".steps-wrapper").prepend(page);

    $(".crs_text a").click(function () {
      pushDataLayer([
        "exp_valu_prop_lin_thankpage_research",
        "Research",
        "Link",
        "You'll be contacted by a Solar Expert Partner in City within a couple of hours",
      ]);
    });
    handleVisibility(document.querySelector(".crs_thank h2"), [
      "exp_valu_prop_vis_thankpage_full",
      "Full page view",
      "Visibility ",
      "You'll be contacted by a Solar Expert Partner in City within a couple of hours",
    ]);
    handleVisibility(document.querySelector(".crs_analyzing li:nth-child(1)"), [
      "exp_valu_prop_vis_thankpage_bill",
      "Your Latest Energy Bill",
      "Visibility ",
      "You'll be contacted by a Solar Expert Partner in City within a couple of hours",
    ]);
    handleVisibility(document.querySelector(".crs_analyzing li:nth-child(2)"), [
      "exp_valu_prop_vis_thankpage_recom",
      "Recommended Number of Panels",
      "Visibility ",
      "You'll be contacted by a Solar Expert Partner in City within a couple of hours",
    ]);
    handleVisibility(document.querySelector(".crs_analyzing li:nth-child(3)"), [
      "exp_valu_prop_vis_thankpage_savin",
      "Estimated 20-Year Savings",
      "Visibility ",
      "You'll be contacted by a Solar Expert Partner in City within a couple of hours",
    ]);
  }
}

new changeFlow(device);
